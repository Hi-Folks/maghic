name: roberto-butti/maghic
'on':
    push:
        branches:
            - main
jobs:
    build:
        runs-on:
            - ubuntu-latest
        services:
            mysql:
                image: 'mysql:latest'
                env: { MYSQL_ALLOW_EMPTY_PASSWORD: 'yes', MYSQL_DATABASE: db_test_laravel }
                ports: ['33306:3306']
                options: '--health-cmd="mysqladmin ping" --health-interval=10s --health-timeout=5s --health-retries=3'
        steps:
            -
                name: 'Install PHP versions'
                uses: shivammathur/setup-php@v2
                with: { php-version: '${{ matrix.php }}' }
            -
                name: Checkout
                uses: actions/checkout@v2
            -
                name: 'php version'
                run: 'php -v'
            -
                name: 'Install Dependencies'
                run: 'composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist'
            -
                name: 'Execute Code Sniffer via phpcs'
                run: 'vendor/bin/phpcs --standard=PSR12 app'
            -
                name: 'Execute Static Code Analysis'
                run: 'vendor/bin/phpstan analyse -c ./phpstan.neon --no-progress'
        strategy:
            matrix:
                php: ['8.0', '8.1']
